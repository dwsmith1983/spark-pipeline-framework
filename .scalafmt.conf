version = "3.7.17"

# Scala dialect - support both 2.12 and 2.13
runner.dialect = scala213source3

# Line length - matches scalastyle FileLineLengthChecker maxLineLength=120
maxColumn = 120

# Indentation - matches scalastyle tabSize=2
indent.main = 2
indent.callSite = 2
indent.defnSite = 2
indent.ctorSite = 2
indent.caseSite = 2
indent.extendSite = 2
indent.withSiteRelativeToExtends = 2

# Alignment settings
align.preset = more
align.openParenCallSite = false
align.openParenDefnSite = false
align.arrowEnumeratorGenerator = true
align.tokens."+" = [
  { code = "=>", owner = "Case" }
  { code = "<-", owner = "Enumerator.Generator" }
  { code = "%", owner = "Term.ApplyInfix" }
  { code = "%%", owner = "Term.ApplyInfix" }
]

# Newlines
newlines.source = keep
newlines.topLevelStatementBlankLines = [
  { blanks { before = 1 } }
]
newlines.beforeCurlyLambdaParams = multilineWithCaseOnly
newlines.afterCurlyLambdaParams = squash
newlines.implicitParamListModifierPrefer = before
newlines.avoidForSimpleOverflow = [tooLong, punct, slc]

# Rewrite rules
rewrite.rules = [
  AvoidInfix
  RedundantBraces
  RedundantParens
  SortModifiers
  PreferCurlyFors
]
rewrite.redundantBraces.stringInterpolation = true
rewrite.redundantBraces.generalExpressions = false
rewrite.sortModifiers.order = [
  "override", "private", "protected", "final", "sealed", "abstract", "implicit", "lazy"
]

# Imports
rewrite.imports.sort = scalastyle
rewrite.imports.groups = [
  ["com\\.example\\..*"]
  ["org\\.apache\\.spark\\..*"]
  [".*"]
  ["scala\\..*"]
  ["java\\..*", "javax\\..*"]
]

# Spaces - matches scalastyle SpacesAfterPlusChecker, SpacesBeforePlusChecker
spaces.inImportCurlyBraces = false
spaces.inParentheses = false
spaces.afterKeywordBeforeParen = true
spaces.inByNameTypes = true
spaces.beforeContextBoundColon = Never

# Docstrings
docstrings.style = Asterisk
docstrings.blankFirstLine = yes
docstrings.wrap = no
docstrings.oneline = fold

# Trailing commas - Scala 2.12+ compatible
trailingCommas = preserve

# Vertical multiline - for method definitions and calls
verticalMultiline.atDefnSite = true
verticalMultiline.arityThreshold = 4
verticalMultiline.newlineAfterOpenParen = true

# Dangline parentheses
danglingParentheses.preset = true
danglingParentheses.callSite = true
danglingParentheses.defnSite = true

# Option fit - for chained method calls
optIn.configStyleArguments = true

# Comment wrapping - disabled to preserve manual formatting
comments.wrap = standalone
comments.wrapStandaloneSlcAsSlc = true

# Project settings
project.git = true
project.excludeFilters = [
  ".metals"
  "target"
  ".sbt"
]

# File override for sbt files
fileOverride {
  "glob:**/*.sbt" {
    runner.dialect = sbt1
  }
  "glob:**/project/*.scala" {
    runner.dialect = scala212
  }
}
